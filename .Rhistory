geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
theme_kp()
### OUTPUT
write_csv(combined_flux,"processed/input_output.csv")
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/20, fill = Watershed), stat = "identity", alpha = 0.3)+
geom_point(data=combined_flux,aes(x = WY, y = N_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out2), shape=1, stroke=1)+
#geom_point(data=combined_flux,aes(x = WY, y = N_ret), shape=1, stroke=1, size=2)+
geom_path(data=combined_flux,aes(x = WY, y = N_out2))+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention, kg/ha"))+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor",direction=-1)+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(fill=Watershed,x = WY, y = S_cumret/5), stat = "identity", alpha = 0.5)+
geom_point(data=combined_flux,aes(x = WY, y = S_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out2), shape=1, stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_out2))+
#geom_point(data=combined_flux,aes(x = WY, y = S_ret), shape=1, stroke=1, size=2)+
scale_y_continuous(sec.axis = sec_axis(~.*5, name = "cum retention"))+
ylab("S, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
facet_wrap(~Watershed)+
theme_kp()
deposition %>%
dplyr::mutate(S_WB = case_when(YEAR==1988~S_in,
YEAR>1988&YEAR<2017~S_in+25,
YEAR>2016~S_in))->deposition
### OUTPUT  ----
write_csv(combined_flux,"processed/input_output.csv")
write_csv(bbwm_dep_processed,"processed/deposition.csv")
source("0-bbwm_packages.R")
source("1-bbwm_recovery_ns_Rcode.R")
source("1-streams.R")
make(plan)
source("2-input_fluxes.R")
# 1. input files ----
bbwm_dep = read.csv("data/dep_bbwm_annual.csv")
how_dep = read.csv("data/dep_how_annual.csv")
gville_dep_seasonal = read.csv("data/dep_gville_seasonal.csv")
# clean the files
bbwm_dep %>%
dplyr::rename(YEAR = CalYear) %>%
select(YEAR, S_WET, N_WET) %>%
filter(!YEAR=="2013")->
bbwm_dep
how_dep %>%
filter(SITE_ID=="HOW191") %>%
#filter(YEAR>2012) %>%
select(YEAR, S_WET, N_WET, S_DRY, N_DRY)->
how_dep
N_FACTOR = mean(how_dep$N_DRY/how_dep$N_WET)
S_FACTOR = mean(how_dep$S_DRY/how_dep$S_WET)
# plots to check trends
ggplot(how_dep, aes(y = N_WET/N_DRY, x = YEAR))+
geom_point()
dep = rbind(bbwm_dep,how_dep)
source("2-input_fluxes.R")
all = read.csv("processed/concentrations.csv")
annual = read.csv("processed/fluxes.csv")
summary = read.csv("processed/summary.csv")
deposition = read.csv("processed/deposition.csv")
combined_flux = read.csv("processed/input_output.csv")
summary %>%
dplyr::select(species,Watershed,period,summary) %>%
dplyr::mutate(period = factor(period, levels = c("pre-treatment","first decade","second decade","third decade","recovery"))) %>%
spread(period,summary) %>%
knitr::kable(align = "r")
summary %>%
dplyr::select(species,Watershed,period,summary) %>%
dplyr::mutate(period = factor(period, levels = c("pre-treatment","first decade","second decade","third decade","recovery"))) %>%
spread(period,summary) %>%
knitr::kable(align = "r")
source("0-bbwm_packages.R")
summary %>%
dplyr::select(species,Watershed,period,summary) %>%
dplyr::mutate(period = factor(period, levels = c("pre-treatment","first decade","second decade","third decade","recovery"))) %>%
spread(period,summary) %>%
knitr::kable(align = "r")
summary %>%
dplyr::select(species,Watershed,period,summary) %>%
dplyr::mutate(period = factor(period, levels = c("pre-treatment","first decade","second decade","third decade","recovery"))) %>%
spread(period,summary) %>%
knitr::kable(align = "r")
annual %>%
dplyr::select(Watershed,period, NO3_N, SO4_S) %>%
filter(!(period == "recovery" | period=="pre-treatment")) %>%
group_by(Watershed) %>%
dplyr::summarize(N = mean(NO3_N),
S = mean(SO4_S))
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
ylab("NO3-N conc, mg/L")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_line(aes(y = SO4_S),color="black",size=0.6)+
geom_point(aes(y = SO4_S), size=2, stroke=1)+
ylab("SO4-S conc, mg/L")+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 4, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 4, angle = 90,size=4, hjust = "right")+
theme_kp()
all %>%
dplyr::filter(Year>2013) %>%
group_by(Watershed, Year, Month, Day) %>%
dplyr::summarise(NO3_N = mean(NO3_N, na.rm = TRUE),
SO4_S = mean(SO4_S, na.rm = TRUE)) %>%
ungroup %>%
dplyr::mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-")))->temp
ggplot(temp,aes(x = date2, y = NO3_N, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
geom_path(linetype = "dashed", size=1)+
scale_color_hp(discrete=TRUE,option ="Gryffindor", direction=-1)+
scale_shape_manual(values = c(1,16))+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab("NO3-N, mg/L")+
theme_kp()+
scale_x_date(date_breaks = "6 months", date_labels =  "%b %Y") +
#facet_wrap(~Watershed, scales = "free")+
#ylim(0,150)+
#scale_y_continuous(trans='log10')
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = SO4_S, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
geom_path(linetype = "dashed", size=1)+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,16))+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab("SO4-S, mg/L")+
expand_limits(y=0)+
theme_kp()+
scale_x_date(date_breaks = "6 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
deposition %>%
dplyr::mutate(S_WB = case_when(YEAR==1988~S_in,
YEAR>1988&YEAR<2017~S_in+25,
YEAR>2016~S_in))->deposition
ggplot(deposition, aes(x = YEAR, y = S_in))+
geom_path()+
geom_point(aes(shape=data_type), size=2, stroke=1)+
# geom_path(aes(x = YEAR,y = (S_WB)),color = "red")+
scale_shape_manual(values = c(1,19))+
#ylim(0,7)+
ylab(expression(bold("S, kg ha"^-1*" yr"^-1)))+
theme_kp()
ggplot(deposition, aes(x = YEAR, y = N_in))+
geom_path()+
geom_point(aes(shape=data_type), size=2, stroke=1)+
scale_shape_manual(values = c(1,19))+
#  ylim(0,7)+
ylab(expression(bold("N, kg ha"^-1*" yr"^-1)))+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/20, fill = Watershed), stat = "identity", alpha = 0.3)+
geom_point(data=combined_flux,aes(x = WY, y = N_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out2), shape=1, stroke=1)+
#geom_point(data=combined_flux,aes(x = WY, y = N_ret), shape=1, stroke=1, size=2)+
geom_path(data=combined_flux,aes(x = WY, y = N_out2))+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention, kg/ha"))+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor",direction=-1)+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(fill=Watershed,x = WY, y = S_cumret/5), stat = "identity", alpha = 0.5)+
geom_point(data=combined_flux,aes(x = WY, y = S_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out2), shape=1, stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_out2))+
#geom_point(data=combined_flux,aes(x = WY, y = S_ret), shape=1, stroke=1, size=2)+
scale_y_continuous(sec.axis = sec_axis(~.*5, name = "cum retention"))+
ylab("S, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/5), stat = "identity", alpha = 0.5)+
geom_point(data=combined_flux,aes(x = WY, y = S_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out2), shape=1, stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_out2))+
#geom_point(data=combined_flux,aes(x = WY, y = S_ret), shape=1, stroke=1, size=2)+
scale_y_continuous(sec.axis = sec_axis(~.*5, name = "cum retention"))+
ylab("S, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
facet_wrap(~Watershed)+
theme_kp()
View(combined_flux)
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/20), stat = "identity", alpha = 0.3)+
geom_point(data=combined_flux,aes(x = WY, y = N_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out2), shape=1, stroke=1)+
#geom_point(data=combined_flux,aes(x = WY, y = N_ret), shape=1, stroke=1, size=2)+
geom_path(data=combined_flux,aes(x = WY, y = N_out2))+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention, kg/ha"))+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor",direction=-1)+
facet_wrap(~Watershed)+
theme_kp()
gg_n =
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO[3]-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_n
gg_n =
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"{3}"-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_n =
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO{3}-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_n
gg_n =
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO[3]-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_n
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO[3]-N, mg L")))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO[3]-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"*[3]*"-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO[3]-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3],"-N, mg L"^-1)))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3],"-N, mg L"^{-1})))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3]"-N, mg L"^{-1})))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3], "-N, mg L"^{-1})))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3], "-N, mg L"^{-1})))+
labs (y = expression (bold ("NO"[3] "-N")),
x = expression (bold ("WY")))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3], "-N, mg L"^{-1})))+
labs (y = expression (bold ("NO"[3]*"-N")),
x = expression (bold ("WY")))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_line(aes(y = NO3_N),color="black",size=0.6)+
geom_point(aes(y = NO3_N), size=1.5, stroke=1)+
#ylab("NO3-N conc, mg/L")+
ylab(expression(bold("NO"[3]*"-N, mg L"^{-1})))+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 1, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 1, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_s =
ggplot(annual, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_line(aes(y = SO4_S),color="black",size=0.6)+
geom_point(aes(y = SO4_S), size=2, stroke=1)+
ylab(expression(bold("SO"[4]*"-S, mg L"^{-1})))+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 4, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 4, angle = 90,size=4, hjust = "right")+
theme_kp()
gg_s
ggplot(temp,aes(x = date2, y = NO3_N, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
geom_path(linetype = "dashed", size=1)+
scale_color_hp(discrete=TRUE,option ="Gryffindor", direction=-1)+
scale_shape_manual(values = c(1,16))+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab(expression(bold("NO"[3]*"-N, mg L"^{-1})))+
theme_kp()+
scale_x_date(date_breaks = "6 months", date_labels =  "%b %Y") +
#facet_wrap(~Watershed, scales = "free")+
#ylim(0,150)+
#scale_y_continuous(trans='log10')
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/20), stat = "identity", alpha = 0.3)+
geom_point(data=combined_flux,aes(x = WY, y = N_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out2), shape=1, stroke=1)+
#geom_point(data=combined_flux,aes(x = WY, y = N_ret), shape=1, stroke=1, size=2)+
geom_path(data=combined_flux,aes(x = WY, y = N_out2))+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention, kg/ha"))+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
ylab(expression(bold("N kg ha"^{-1}*"yr"^{-1})))+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor",direction=-1)+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/20), stat = "identity", alpha = 0.3)+
geom_point(data=combined_flux,aes(x = WY, y = N_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out2), shape=1, stroke=1)+
#geom_point(data=combined_flux,aes(x = WY, y = N_ret), shape=1, stroke=1, size=2)+
geom_path(data=combined_flux,aes(x = WY, y = N_out2))+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention, kg/ha"))+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab(expression(bold("N, kg ha"^{-1}*"yr"^{-1})))+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor",direction=-1)+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/5), stat = "identity", alpha = 0.5)+
geom_point(data=combined_flux,aes(x = WY, y = S_in), stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out2), shape=1, stroke=1)+
geom_path(data=combined_flux,aes(x = WY, y = S_out2))+
#geom_point(data=combined_flux,aes(x = WY, y = S_ret), shape=1, stroke=1, size=2)+
scale_y_continuous(sec.axis = sec_axis(~.*5, name = "cum retention"))+
ylab(expression(bold("S, kg ha"^{-1}*"yr"^{-1})))+
geom_vline(xintercept = 1989.5, linetype="dashed")+
geom_vline(xintercept = 2016.5, linetype="dashed")+
geom_hline(yintercept = 0)+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
facet_wrap(~Watershed)+
theme_kp()
gg_ret_s+gg_ret_n
