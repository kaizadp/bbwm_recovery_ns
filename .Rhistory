geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), color="white")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), color="grey")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), color="darkgrey")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="darkgrey",size=0.6)+
geom_point(aes(y = so4_v*10), color="darkgrey")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity")+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 650, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 650, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot (na.omit(annual), aes(x = WY, y = EQPH,color = Watershed,shape = Watershed,linetype=Watershed))+
geom_smooth(color = "grey",alpha = 0.2)+
geom_point(size=3,stroke=1.5)+
scale_color_got(discrete=TRUE,option = "tully")+
scale_shape_manual(values = c(1,19))+
geom_vline(xintercept = 1989.2,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 7, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 7, angle = 90,size=4, hjust = "right")+
labs (y = expression (bold ("Air-equilibrated pH"),
x = expression (bold ("WY"))))+
theme_kp()+
theme (legend.position = "none")
all %>%
dplyr::filter(Year>2015) %>%
dplyr::mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-")))->temp
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Hufflepuff")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Ravenclaw")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,16))+
#ylim(0,15)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.8)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.9)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10))+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=2)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=3)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=2.5)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=2.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=2, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.85)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity")+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed, shape = Watershed))+
geom_bar(aes(y = so4),stat = "identity", alpha = 0.9)+
geom_line(aes(y = so4_v*10),color="black",size=0.6)+
geom_point(aes(y = so4_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_manual(values = c("#bebebe","darkgreen"))+
scale_fill_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,19))+
#scale_fill_manual(values = c("#6f8ea9","#003b8f"))+
#scale_fill_manual(values = c("#d9d9d9","#D95F02"))+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 2500, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 2500, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity")+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 650, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 650, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity", alpha = 0.8)+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc"))+
ylab("flux")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 650, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 650, angle = 90,size=4, hjust = "right")+
theme_kp()
View(annual2)
annual2 %>% select(WY,Watershed, SO4) %>%
spread(Watershed, SO4)->so4temp
View(so4temp)
so4temp %>% dplyr::mutate(WB_EB = WB/EB)->so4temp
ggplot(so4temp, aes(x = WY, y = WB_EB))+geom_point()
ggplot(so4temp, aes(x = WY, y = WB_EB))+geom_point()+geom_path()
annual2 %>% select(WY,Watershed, NO3) %>%spread(Watershed,NO3)->no3temp
View(no3temp)
no3temp %>% mutate(WB_EB = WB/EB)->no3temp
ggplot(x = WY, y = WB_EB)+geom_point(no3temp, color = "red")+geom_point(so4temp, color = "blue")
ggplot(aes(x = WY, y = WB_EB))+geom_point(no3temp, color = "red")+geom_point(so4temp, color = "blue")
ggplot()+geom_point(no3temp,aes(x = WY, y = WB_EB), color = "red")+geom_point(so4temp, aes(x = WY, y = WB_EB),color = "blue")
ggplot()+geom_point(no3temp,aes(x = WY, y = WB_EB))+geom_point(so4temp, aes(x = WY, y = WB_EB))
ggplot()+geom_point(data=no3temp,aes(x = WY, y = WB_EB))+geom_point(data=so4temp, aes(x = WY, y = WB_EB))
ggplot()+geom_point(data=no3temp,aes(x = WY, y = WB_EB), color="red")+geom_point(data=so4temp, aes(x = WY, y = WB_EB),color="blue")
ggplot()+geom_point(data=no3temp[!no3temp$WY==2010,],aes(x = WY, y = WB_EB), color="red")+geom_point(data=so4temp, aes(x = WY, y = WB_EB),color="blue")
ggplot()+geom_point(data=no3temp[!no3temp$WY==2010,],aes(x = WY, y = WB_EB), color="red")+geom_point(data=so4temp, aes(x = WY, y = WB_EB),color="blue")+ylim(0,200)
ggplot()+geom_point(data=no3temp[!no3temp$WY==2010,],aes(x = WY, y = WB_EB), color="red")+geom_point(data=so4temp, aes(x = WY, y = WB_EB),color="blue")+ylim(0,100)
annual2 %>% group_by(Watershed) %>% summarize(meanSO4 = mean(SO4))
annual2 %>% group_by(Watershed) %>% dplyr::summarize(meanSO4 = mean(SO4))
all %>%
dplyr::filter(Year>2015) %>%
dplyr::mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-")))->temp
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,16))+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab(" NO3, ueq/L)")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = SO4, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
# geom_path(size=1)+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,16))+
ylim(0,200)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab(" SO4, ueq/L)")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
all %>%
dplyr::filter(Year>2015) %>%
dplyr::mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-")))->temp
ggplot(temp,aes(x = date2, y = NO3, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
#  geom_path(size=1)+
# geom_smooth(method = lm, formula = y ~ splines::bs(x, 40), se = FALSE)+
scale_color_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,16))+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab("NO3, ueq/L")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(temp,aes(x = date2, y = SO4, color = Watershed,shape=Watershed))+
geom_point(size=2,stroke=1.5)+
# geom_path(size=1)+
scale_color_hp(discrete=TRUE,option ="Slytherin")+
scale_shape_manual(values = c(1,16))+
ylim(0,200)+
geom_vline(xintercept = unclass(as.Date("2016-11-01")),linetype = "longdash")+
xlab("")+
ylab(" SO4, ueq/L")+
theme_kp()+
scale_x_date(date_breaks = "4 months", date_labels =  "%b %Y") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
