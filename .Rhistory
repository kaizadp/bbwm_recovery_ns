group_by(Watershed) %>%
dplyr::mutate(N_ret = N_in-N_out,
S_ret = S_in-S_out,
N_out = N_out*-1,
S_out = S_out*-1,
N_cumret = cumsum(N_ret),
S_cumret = cumsum(S_ret))
N_in = N_bb,
S_in = S_bb,
N_out = NO3_N,
S_out = SO4_S) %>%
group_by(Watershed) %>%
dplyr::mutate(N_ret = N_in-N_out,
S_ret = S_in-S_out,
N_out = N_out*-1,
S_out = S_out*-1,
N_cumret = cumsum(N_ret), na.action=na.omit,
S_cumret = cumsum(S_ret))
combined_flux =
bbwm_dep_processed %>%
dplyr::mutate(Watershed="EB") %>%
rbind(temp_flux_WB) %>%
dplyr::rename(WY=YEAR) %>%
left_join(select(annual, WY, Watershed,NO3_N, SO4_S), by = c("WY","Watershed")) %>%
dplyr::rename(
N_in = N_bb,
S_in = S_bb,
N_out = NO3_N,
S_out = SO4_S) %>%
group_by(Watershed) %>%
dplyr::mutate(N_ret = N_in-N_out,
S_ret = S_in-S_out,
N_out = N_out*-1,
S_out = S_out*-1,
N_cumret = cumsum(N_ret), na.action=na.omit,
S_cumret = cumsum(S_ret), na.action=na.omit)
N_in = N_bb,
S_in = S_bb,
N_out = NO3_N,
S_out = SO4_S) %>%
filter(!WY==1988) %>%
group_by(Watershed) %>%
dplyr::mutate(N_ret = N_in-N_out,
S_ret = S_in-S_out,
N_out = N_out*-1,
S_out = S_out*-1,
N_cumret = cumsum(N_ret),
S_cumret = cumsum(S_ret))
combined_flux =
bbwm_dep_processed %>%
dplyr::mutate(Watershed="EB") %>%
rbind(temp_flux_WB) %>%
dplyr::rename(WY=YEAR) %>%
left_join(select(annual, WY, Watershed,NO3_N, SO4_S), by = c("WY","Watershed")) %>%
dplyr::rename(
N_in = N_bb,
S_in = S_bb,
N_out = NO3_N,
S_out = SO4_S) %>%
filter(!WY==1988) %>%
group_by(Watershed) %>%
dplyr::mutate(N_ret = N_in-N_out,
S_ret = S_in-S_out,
N_out = N_out*-1,
S_out = S_out*-1,
N_cumret = cumsum(N_ret),
S_cumret = cumsum(S_ret))
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret), stat = "identity")+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret), stat = "identity")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
annual %>%
dplyr::mutate(no3 = if_else(Watershed=="EB",-1*NO3_N,NO3_N),
so4 = if_else(Watershed=="EB",-1*SO4_S,as.numeric(SO4_S)),
no3_v = if_else(Watershed=="EB",-1*NO3_vol,NO3_vol),
so4_v = if_else(Watershed=="EB",-1*SO4_vol,SO4_vol),)->annual2
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity", alpha = 0.8)+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
ylab("NO3-N flux, kg/ha/yr")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 10, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 10, angle = 90,size=4, hjust = "right")+
theme_kp()
library(harrypotter)
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity", alpha = 0.8)+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
ylab("NO3-N flux, kg/ha/yr")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 10, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 10, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity", alpha = 0.8)+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
#  scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
ylab("NO3-N flux, kg/ha/yr")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 10, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 10, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot(annual2, aes(x = WY, fill = Watershed,shape=Watershed))+
geom_bar(aes(y = no3),stat = "identity", alpha = 0.8)+
geom_line(aes(y = no3_v*10),color="black",size=0.6)+
geom_point(aes(y = no3_v*10), size=1.5, stroke=1)+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
ylab("NO3-N flux, kg/ha/yr")+
#scale_fill_brewer(palette = "Dark2")+
#scale_fill_manual(values = c("#bebebe","#D95F02"))+
scale_fill_hp(discrete=TRUE,option ="Gryffindor")+
scale_shape_manual(values = c(1,19))+
geom_hline(yintercept = 0,size=0.3)+
geom_vline(xintercept = 1989.5,linetype="dashed")+
geom_vline(xintercept = 2016.5,linetype="dashed")+
annotate("text", label = "pre-treatment", x = 1988, y = 10, angle = 90,size=4, hjust = "right")+
annotate("text", label = "recovery", x = 2017.5, y = 10, angle = 90,size=4, hjust = "right")+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret*10), stat = "identity")+
scale_y_continuous(sec.axis = sec_axis(~./10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.1)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "conc kg/L"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed, scales="free_y")
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed, scales="free_y")+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = S_in))+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out))+
geom_path(data=combined_flux,aes(x = WY, y = S_out))+
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed, scales="free_y")+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = S_in))+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out))+
geom_path(data=combined_flux,aes(x = WY, y = S_out))+
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
xlab("N, kg/ha/yr")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
xlab("N, kg/ha/yr")+
annotate("text", x = 1990, y = 20)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
xlab("N, kg/ha/yr")+
annotate("text", label = "input",x = 1990, y = 20)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
xlab("N, kg/ha/yr")+
annotate("text", label = "input",x = 1995, y = 20)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
xlab("N, kg/ha/yr")+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
xlab("N, kg/ha/yr")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention, kg/ha"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = S_in))+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out))+
geom_path(data=combined_flux,aes(x = WY, y = S_out))+
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2)+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2, fill = "red")+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2, fill = "red")+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
ylab("S, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/5))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*5, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*1, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/20))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.6, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/20))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = N_in), stat = "identity", alpha = 0.5, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = N_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = N_cumret/20))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*20, name = "cum retention"))+
ylab("N, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_bar(data=combined_flux,aes(x = WY, y = S_in), stat = "identity", alpha = 0.2, fill = "blue")+
geom_bar(data=combined_flux,aes(x = WY, y = S_out), stat = "identity", alpha = 0.2)+
geom_point(data=combined_flux,aes(x = WY, y = S_cumret/10))+
geom_hline(yintercept = 0)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
ylab("S, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = S_in))+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out))+
geom_path(data=combined_flux,aes(x = WY, y = S_out))+
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = S_in))+
geom_path(data=combined_flux,aes(x = WY, y = S_in))+
geom_point(data=combined_flux,aes(x = WY, y = S_out))+
geom_path(data=combined_flux,aes(x = WY, y = S_out))+
geom_bar(data=combined_flux,aes(x = WY, y = S_cumret/10), stat = "identity", alpha = 0.2)+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention"))+
ylab("S, kg/ha/yr")+
facet_wrap(~Watershed)+
theme_kp()
ggplot() +
geom_point(data=combined_flux,aes(x = WY, y = N_in))+
geom_path(data=combined_flux,aes(x = WY, y = N_in))+
geom_point(data=combined_flux,aes(x = WY, y = N_out))+
geom_path(data=combined_flux,aes(x = WY, y = N_out))+
geom_bar(data=combined_flux,aes(x = WY, y = N_cumret/10), stat = "identity", alpha = 0.2)+
annotate("text", label = "input",x = 1995, y = 20)+
annotate("text", label = "output",x = 1995, y = -10)+
ylab("N, kg/ha/yr")+
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "cum retention, kg/ha"))+
facet_wrap(~Watershed)+
theme_kp()
source("0-packages.R")
source("0-bbwm_packages")
source("0-bbwm_packages.R")
soil =
read_excel("data/soilN.xlsx", sheet = "Sheet2")
View(soil)
names(soil)
soil2 =
soil %>%
rename(Watershed = WS,
NO3_N_mg_kg = `NO3 (ug N/g soil)`,
NH4_N_mg_kg = `NH4 (ug N/g soil)`) %>%
dplyr::select(Watershed, NO3_N_mg_kg, NH4_N_mg_kg)
soil2 =
soil %>%
dplyr::rename(Watershed = WS,
NO3_N_mg_kg = `NO3 (ug N/g soil)`,
NH4_N_mg_kg = `NH4 (ug N/g soil)`) %>%
dplyr::select(Watershed, NO3_N_mg_kg, NH4_N_mg_kg)
View(soil2)
soil2 =
soil %>%
dplyr::rename(Watershed = WS,
NO3_N_mg_kg = `NO3 (ug N/g soil)`,
NH4_N_mg_kg = `NH4 (ug N/g soil)`) %>%
dplyr::select(Watershed, NO3_N_mg_kg, NH4_N_mg_kg) %>%
dplyr::mutate(Watershed = case_when(Watershed == "BBE" ~ "EB",
Watershed == "BBW" ~ "WB"))
soil3 =
soil2 %>%
group_by(Watershed) %>%
dplyr::summarise(NH4 = round(mean(NH4_N_mg_kg),2),
NO3 = round(mean(NO3_N_mg_kg),2))
View(soil3)
soil3 =
soil2 %>%
group_by(Watershed) %>%
dplyr::summarise(NH4_mean = round(mean(NH4_N_mg_kg),2),
NO3_mean = round(mean(NO3_N_mg_kg),2),
NH4_se = round(sd(NH4_N_mg_kg)/sqrt(n()),2),
NO3_se = round(sd(NO3_N_mg_kg)/sqrt(n()),2))
aov(data = soil2, NH4_N_mg_kg ~ Watershed)
nh4_aov = aov(data = soil2, NH4_N_mg_kg ~ Watershed)
summary(nh4_aov)
no3_aov = aov(data = soil2, NO3_N_mg_kg ~ Watershed)
summary(no3_aov)
